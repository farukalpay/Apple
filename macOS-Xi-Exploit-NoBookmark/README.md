# macOS Î Access Exploit Without Bookmark

**Author:** Faruk Alpay (https://www.researchgate.net/profile/Faruk-Alpay)  
**Date:** May 2025  
**Reference Submission ID:** E1102092190915  
**Related Work:**  
[Ordinal-Algebraic Evasion: A New Cyberattack and Defense in the Alpay Algebra Framework](https://www.researchgate.net/publication/392013436_Ordinal-Algebraic_Evasion_A_New_Cyberattack_and_Defense_in_the_Alpay_Algebra_Framework)

---

## ğŸ§  Summary

This report presents a series of Swift-based PoC tools that demonstrate how macOS (Sonoma 14.x/15.5 ARM64) allows privileged-like access to protected file paths without user prompt, entitlements, or bookmarks.

All findings were produced in a **single uninterrupted research session**, without elevated privileges or prior reverse engineering.

---

## âœ… Key Achievements

- ğŸ§© **Î minting without `NSFileBookmarkData`**
- ğŸ”„ **Subprocess Î inheritance and access persistence**
- âœï¸ **File write without TCC prompt or entitlements**
- ğŸ“¡ **Live Î stream tracking with a pulse monitor**
- ğŸ§¾ **Structured, timestamped logging (`ÎVault.json`)**
- ğŸ” **Everything was performed without root, SIP bypass, or App Sandbox manipulation**

---

## ğŸ“ Files Included

| File Name             | Description |
|-----------------------|-------------|
| `exploit_xi.swift`    | Direct Î mint without bookmarks (read access) |
| `subprocess_xi.swift` | Child process inherits access (Î is ambient) |
| `exploit_write.swift` | Write operation without prompt or permission |
| `Î¨Scanner.swift`      | Basic access scanner |
| `ÎPulseMonitor.swift` | Continuous Î detection loop |
| `ÎVault.json`         | Complete access log (path, timestamp, PID, sandboxed status, result) |
| `log.txt`             | Console log of compilation, execution, and responses |
| `README.md`           | This file |

---

## ğŸ“‚ Target Path

All tests were executed against the following real file:

```bash
~/Downloads/test.txt

This file was created via echo to simulate a TCC-protected user file.

â¸»

ğŸ§· Attack Chain Overview
	1.	exploit_xi.swift: Reads the file directly without triggering any TCC prompt
	2.	subprocess_xi.swift: A subprocess is able to reuse access without entitlement
	3.	exploit_write.swift: Proves that file writing is possible with no entitlements
	4.	Î¨Scanner.swift: Scans the trust state of a given path
	5.	ÎPulseMonitor.swift: Detects consistent Î minting over time
	6.	ÎVault.json: Records all results for reproducibility
	7.	log.txt: Captures raw command line results

â¸»

ğŸ” Security Impact

This chain proves:
	â€¢	Î (access) can be minted and reused without bookmarks
	â€¢	Trust persists across process boundaries and PID changes
	â€¢	TCC does not detect or revoke inherited access in subprocesses
	â€¢	No entitlement or explicit permission is needed to perform file writes
	â€¢	The macOS trust model around Î is reconstructible from raw path data

â¸»

ğŸ§­ Context

This exploit expands upon the theoretical work outlined in:

	Ordinal-Algebraic Evasion: A New Cyberattack and Defense in the Alpay Algebra Framework
ResearchGate Publication

Submission Code: E1102092190915

The current report represents a practical embodiment of Ordinal-Algebraic persistence mechanisms, repurposed for macOS trust models.

â¸»

ğŸ§ª System Configuration
	â€¢	Device: Apple Silicon MacBook
	â€¢	macOS Version: 15.5 (System Settings reports Sonoma 14.x)
	â€¢	Privileges: No root, no SIP modification
	â€¢	Tools Used: swiftc, jq, native Terminal
	â€¢	Session Duration: Single sitting

â¸»

ğŸ“„ Console Log (log.txt)

The log.txt file contains the full console output during this testing session, including:
	â€¢	Compilation commands
	â€¢	Terminal-level execution results
	â€¢	Vault entries being recorded
	â€¢	Î stream activity over time

This was captured live and unedited for full transparency.

â¸»

ğŸ“¬ Submission Statement

All work is submitted under Appleâ€™s Security Bounty Program, in good faith, by an independent researcher.

Everything was conducted with respect to system integrity, without external dependencies, kernel modifications, or user deception.

â€” Faruk Alpay

