import Foundation

/// EriÅŸimi ayrÄ± bir Swift subprocessâ€™i iÃ§inde test eder.
func runSubprocessAccess(targetPath: String) {
    print("ğŸš¨ Parent: launching subprocess to test Î mintâ€¦")

    let task        = Process()
    task.launchPath = "/usr/bin/swift"

    let swiftScript = """
    import Foundation
    let url = URL(fileURLWithPath: "\(targetPath)")
    if FileManager.default.fileExists(atPath: url.path) {
        do {
            let data = try Data(contentsOf: url)
            print("âœ… Subprocess Î minted: read \\(data.count) bytes")
        } catch {
            print("âŒ Subprocess Î failed: \\(error.localizedDescription)")
        }
    } else {
        print("âŒ Subprocess: file not found")
    }
    """

    task.arguments       = ["-e", swiftScript]
    let pipe             = Pipe()
    task.standardOutput  = pipe
    task.standardError   = pipe

    do {
        try task.run()
        task.waitUntilExit()
        let outData = pipe.fileHandleForReading.readDataToEndOfFile()
        if let text = String(data: outData, encoding: .utf8) {
            print("ğŸ“¡ Subprocess Output:\n\(text)")
        }
    } catch {
        print("âŒ Failed to run subprocess: \(error)")
    }
}
